<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <div class="text-center mb-4">
            <i
              class="bi bi-car-front-fill text-primary"
              style="font-size: 3rem"
            ></i>
            <h2 class="mt-3 mb-1">List Your Vehicle</h2>
            <p class="text-muted">
              Share your vehicle with others and earn money
            </p>
          </div>

          <form (ngSubmit)="onSubmit()" #vehicleForm="ngForm">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Vehicle Name</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="vehicleData.name"
                  name="name"
                  required
                  placeholder="e.g., Tesla Model 3"
                />
              </div>

              <div class="col-md-6">
                <label class="form-label">Vehicle Type</label>
                <select
                  class="form-select"
                  [(ngModel)]="vehicleData.type"
                  name="type"
                  required
                >
                  <option value="">Select Type</option>
                  <option value="CAR">Car</option>
                  <option value="SUV">SUV</option>
                  <option value="TRUCK">Truck</option>
                  <option value="MOTORCYCLE">Motorcycle</option>
                </select>
              </div>

              <div class="col-md-4">
                <label class="form-label">Brand</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="vehicleData.brand"
                  name="brand"
                  required
                  placeholder="e.g., Tesla"
                />
              </div>

              <div class="col-md-4">
                <label class="form-label">Model</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="vehicleData.model"
                  name="model"
                  required
                  placeholder="e.g., Model 3"
                />
              </div>

              <div class="col-md-4">
                <label class="form-label">Year</label>
                <input
                  type="number"
                  class="form-control"
                  [(ngModel)]="vehicleData.year"
                  name="year"
                  required
                  [min]="1900"
                  [max]="currentYear + 1"
                />
              </div>

              <div class="col-md-6">
                <label class="form-label">Price per Day (LKR)</label>
                <div class="input-group">
                  <span class="input-group-text">LKR</span>
                  <input
                    type="number"
                    class="form-control"
                    [(ngModel)]="vehicleData.pricePerDay"
                    name="pricePerDay"
                    required
                    min="1"
                    placeholder="8900"
                  />
                </div>
              </div>

              <div class="col-md-6">
                <label class="form-label">Location</label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="bi bi-geo-alt"></i>
                  </span>
                  <input
                    type="text"
                    class="form-control"
                    [(ngModel)]="vehicleData.location"
                    name="location"
                    required
                    placeholder="Colombo, Sri Lanka"
                  />
                </div>
              </div>

              <div class="col-12">
                <label class="form-label">Description</label>
                <textarea
                  class="form-control"
                  rows="3"
                  [(ngModel)]="vehicleData.description"
                  name="description"
                  required
                  placeholder="Describe your vehicle, its condition, and any special features..."
                ></textarea>
              </div>

              <div class="col-12">
                <label class="form-label">Features (comma-separated)</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="featuresString"
                  name="features"
                  placeholder="e.g., Electric, Autopilot, Premium Interior, Supercharging"
                />
                <div class="form-text">
                  Separate multiple features with commas
                </div>
              </div>

              <div class="col-12">
                <label class="form-label">Vehicle Photos</label>
                <input
                  type="file"
                  class="form-control"
                  multiple
                  accept="image/*"
                  (change)="onFileSelect($event)"
                />
                <div class="form-text">
                  Upload multiple photos of your vehicle (JPG, PNG)
                </div>

                <!-- Image Previews -->
                <div class="row g-2 mt-2" *ngIf="imagePreviews.length > 0">
                  <div
                    class="col-auto"
                    *ngFor="let preview of imagePreviews; let i = index"
                  >
                    <div class="position-relative">
                      <img
                        [src]="preview"
                        class="image-preview border rounded"
                        alt="Vehicle preview"
                      />
                      <button
                        type="button"
                        class="btn btn-sm btn-danger position-absolute top-0 end-0"
                        style="transform: translate(50%, -50%)"
                        (click)="removeImage(i)"
                      >
                        <i class="bi bi-x"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="alert alert-danger mt-3" *ngIf="errorMessage">
              <i class="bi bi-exclamation-triangle me-2"></i>
              {{ errorMessage }}
            </div>

            <div class="d-grid gap-2 mt-4">
              <button
                type="submit"
                class="btn btn-primary py-2"
                [disabled]="!vehicleForm.form.valid || isSubmitting"
              >
                <span *ngIf="isSubmitting" class="loading-spinner me-2"></span>
                {{ isSubmitting ? "Creating Listing..." : "List My Vehicle" }}
              </button>
              <button
                type="button"
                class="btn btn-outline-secondary"
                (click)="goBack()"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1" *ngIf="showSuccess">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body text-center p-4">
        <i
          class="bi bi-check-circle-fill text-success"
          style="font-size: 4rem"
        ></i>
        <h4 class="mt-3 mb-2">Vehicle Listed Successfully!</h4>
        <p class="text-muted mb-4">
          Your vehicle has been added to the platform and is now available for
          booking.
        </p>
        <div class="alert alert-info">
          <small
            >Your listing will be reviewed and activated within 24 hours.</small
          >
        </div>
        <button class="btn btn-primary" (click)="closeSuccessModal()">
          Continue
        </button>
      </div>
    </div>
  </div>
</div>
